#!/bin/bash

# API Request Automation - Task 0
# Fetches Pikachu data from Pokemon API and saves to data.json

API_URL="https://pokeapi.co/api/v2/pokemon/pikachu"
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"

echo "Fetching Pikachu data from Pokemon API..."

# Make API request and save response
if curl -s "$API_URL" -o "$OUTPUT_FILE"; then
    # Check if the response is valid JSON
    if jq empty "$OUTPUT_FILE" 2>/dev/null; then
        echo "✅ Data successfully saved to $OUTPUT_FILE"
    else
        echo "❌ Invalid JSON response received"
        echo "$(date): Invalid JSON response from $API_URL" >> "$ERROR_FILE"
        exit 1
    fi
else
    # Log error if request fails
    echo "❌ Failed to fetch data from API"
    echo "$(date): Failed to fetch data from $API_URL" >> "$ERROR_FILE"
    exit 1
fi